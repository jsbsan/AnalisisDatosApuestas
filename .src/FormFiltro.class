' Gambas class file

Public listado As String[]

Public Sub ButtonBuscar_Click()
    ' TextArea1.text = listado[0]

    Dim lineas As String[]
    Dim a As Integer

    TextArea1.text = ""
    lineas = Split(listado[0], "\n")
    Me.Title = "Buscando: " & TextBoxFiltro.text
    For a = 0 To lineas.count - 1
        If comun.contiene(lineas[a], TextBoxFiltro.text) Then
            If InStr(Upper(lineas[a]), Upper("comentario:")) = 0 Then
                TextArea1.text &= lineas[a] & "\n"
            Else
                TextBoxComentario.text = lineas[a]
            Endif
        Endif

    Next
    TextArea1.text = Lower(TextArea1.text)
    TextArea1.text = "ID" & "\t" & "fecha" & "\t" & "Movimiento" & "\t" & "Importe" & "\t" & "Nota" & "\n" & TextArea1.text
    comun.DefinirGridSinFormato(GridViewDatos, TextArea1.text)

    'aplico formato al gridview de datos.
    GridViewDatos.Columns[0].width = 110 'nombre del id de apuesta
    GridViewDatos.Columns[1].width = 80
    GridViewDatos.Columns[2].width = 110
    GridViewDatos.Columns[3].Alignment = Align.Right

    For a = 0 To GridViewDatos.Rows.count - 1
        GridViewDatos[a, 3].Alignment = Align.Right

    Next

End

Public Sub TextBoxFiltro_KeyPress()

    If Key.code = Key.enter Or Key.code = Key.return Then
        ButtonBuscar_Click()
    Endif

End

Public Sub Form_Open()

End

Public Sub FiltroDado(Idtexto As String)

    TextBoxFiltro.text = Idtexto

    ButtonBuscar_Click()

End
